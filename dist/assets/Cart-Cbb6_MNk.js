import{u as O,e as M,d as A,r as f,j as e,m as o,A as W,V as F,i as C,k as Y,l as Q,B as G,n as X,o as K,p as B,R as $,a as U,F as J,q as Z,g as ee}from"./index-BJZVsLRM.js";import{F as P,T as k}from"./Constant-B8kb6R2V.js";import{u as se}from"./useOffer-DyTfaEES.js";function te({total:s,onCheckout:r,isCheckingOut:d,cartEmpty:m}){return e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-foreground/50 pb-3 flex justify-between items-center lg:hidden mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:"Cart Total:"}),e.jsxs("p",{className:"text-base font-bold",children:["₹",s.toFixed(2)]})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:r,disabled:m||d,className:"bg-foreground text-white px-4 py-2 text-sm uppercase disabled:bg-gray-200 disabled:text-gray-500",children:d?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-4 h-4 border-2 border-t-transparent border-foreground"}):"Checkout"})]})}function ae(){return e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 uppercase text-foreground font-medium text-xs sm:text-sm border-b border-foreground/50 pb-2 mb-3 sm:mb-4",children:[e.jsx("h1",{className:"text-left col-span-1",children:"Product"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 col-span-1 sm:col-span-4 text-right gap-2",children:[e.jsx("h1",{className:"sm:hidden",children:"Details"}),e.jsx("h1",{className:"hidden sm:block",children:"Price"}),e.jsx("h1",{className:"hidden sm:block",children:"Quantity"}),e.jsx("h1",{className:"hidden sm:block",children:"Subtotal"}),e.jsx("h1",{className:"hidden sm:block",children:"Action"})]})]})}function re({item:s,idx:r,onIncrement:d,onDecrement:m,onRemove:n}){const u=s.finalPrice*s.quantity,l=Array.isArray(s.images)?s.images[0]:s.image,a=O();return e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:r*.1},whileHover:{scale:1.01},className:"grid grid-cols-1 sm:grid-cols-5 gap-2 sm:gap-4 md:gap-6 items-start sm:items-center border-b border-foreground/50 pb-3 sm:pb-4",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-2 sm:gap-3 md:gap-4 col-span-1 sm:col-span-2 cursor-pointer",children:[e.jsx(o.img,{src:l,alt:s.name,className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 object-cover object-top",whileHover:{scale:1.05},transition:{duration:.2},onClick:()=>a(`/product/${s._id}`)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium text-foreground capitalize line-clamp-1",children:s.name}),(s.addons.withFallPico||s.addons.withTassels)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Addons:",s.addons.withFallPico&&` With Fall Pico (+₹${P})`,s.addons.withFallPico&&s.addons.withTassels&&", ",s.addons.withTassels&&`With Tassels (+₹${k})`]}),e.jsxs("div",{className:"sm:hidden flex flex-col mt-2 gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Price:"}),e.jsxs("span",{className:"text-xs text-foreground",children:["₹",s.finalPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center justify-center border border-foreground/50 w-20 py-1",children:[e.jsx(o.button,{disabled:s.quantity<=1,onClick:()=>m(s._id,-1,r),whileTap:{scale:.9},className:"px-1 py-1 text-foreground hover:text-primary text-xs",children:"–"}),e.jsx("input",{type:"text",value:s.quantity,readOnly:!0,className:"w-8 text-center border-x border-foreground/50 text-xs text-foreground"}),e.jsx(o.button,{onClick:()=>d(s._id,1,r),whileTap:{scale:.9},className:"px-1 py-1 text-gray-600 hover:text-primary text-xs",children:"+"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Subtotal:"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#16a34a"},animate:{scale:1,color:"#1f2937"},transition:{duration:.3},className:"text-xs text-foreground",children:["₹",u.toFixed(2)]},u)]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Action:"}),e.jsx(o.button,{onClick:()=>n(s._id,r),whileHover:{scale:1.1,color:"#b91c1c"},whileTap:{scale:.9},className:"text-red-500 text-xs",children:"Remove"})]})]})]})]}),e.jsxs("div",{className:"hidden sm:grid sm:grid-cols-4 col-span-3 items-center justify-items-center gap-2 sm:gap-4 md:gap-6",children:[e.jsxs("span",{className:"text-xs sm:text-sm md:text-base text-foreground",children:["₹",s.finalPrice.toFixed(2)]}),e.jsxs("div",{className:"flex items-center justify-center border border-foreground/50 w-20 sm:w-24 py-2 sm:py-3",children:[e.jsx(o.button,{disabled:s.quantity<=1,onClick:()=>m(s._id,-1,r),whileTap:{scale:.9},className:"px-1 sm:px-2 py-1 text-foreground hover:text-primary text-xs sm:text-sm",children:"–"}),e.jsx("input",{type:"text",value:s.quantity,readOnly:!0,className:"w-8 sm:w-10 text-center border-x border-foreground/50 text-xs sm:text-sm text-foreground"}),e.jsx(o.button,{onClick:()=>d(s._id,1,r),whileTap:{scale:.9},className:"px-1 sm:px-2 py-1 text-foreground hover:text-primary text-xs sm:text-sm",children:"+"})]}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},className:"text-sm sm:text-base md:text-lg font-normal text-foreground",children:["₹",u.toFixed(2)]},u),e.jsx(o.button,{onClick:()=>n(s._id,r),whileHover:{scale:1.1,color:"#b91c1c"},whileTap:{scale:.9},className:"text-red-500 text-xs sm:text-sm md:text-base",children:"Remove"})]})]})}function ne(){return e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center py-8 sm:py-12",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 flex items-center justify-center bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 sm:w-10 sm:h-10 text-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("p",{className:"text-foreground text-sm sm:text-base mb-2",children:"Your cart is empty"}),e.jsx("p",{className:"text-foreground text-xs sm:text-sm mb-6",children:"Add items to your cart to continue shopping"}),e.jsx("button",{className:"bg-foreground text-white px-4 py-2 text-xs sm:text-sm uppercase",children:"Continue Shopping"})]})}function ie({cartItems:s,subtotal:r,discount:d,total:m,coupon:n,setCoupon:u,applyCoupon:l,handleCheckout:a,isCheckingOut:i,cartEmpty:c,appliedCoupon:p,removeCoupon:g,discountPercentage:y}){return e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},className:"col-span-1 p-3 sm:p-4 md:p-6 border shadow-sm",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium uppercase text-foreground mb-3 sm:mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 text-xs sm:text-sm md:text-base",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Your Cart"}),s.map((t,x)=>{const w=t.finalPrice-(t.addons.withFallPico?P:0)-(t.addons.withTassels?k:0),T=t.finalPrice*t.quantity;return e.jsxs("div",{className:"mb-3 border-b pb-2",children:[e.jsx("p",{className:"font-medium line-clamp-1 capitalize",children:t.name}),e.jsxs("p",{children:["Base Price: ₹",w.toFixed(2)," ×"," ",t.quantity," = ₹",(w*t.quantity).toFixed(2)]}),t.addons.withFallPico&&e.jsxs("p",{children:["With Fall Pico: +₹",P," ×"," ",t.quantity," = ₹",(P*t.quantity).toFixed(2)]}),t.addons.withTassels&&e.jsxs("p",{children:["With Tassels: +₹",k," ×"," ",t.quantity," = ₹",(k*t.quantity).toFixed(2)]}),e.jsxs("p",{className:"font-medium",children:["Item Total: ₹",T.toFixed(2)]})]},x)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",r.toFixed(2)]})]}),d>0&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-₹",d.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-foreground/50 pt-2 sm:pt-3 mt-2 sm:mt-3",children:e.jsxs("div",{className:"flex justify-between text-sm sm:text-base md:text-lg font-semibold text-foreground",children:[e.jsx("span",{children:"Total"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},children:["₹",m.toFixed(2)]},m)]})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:t=>u(t.target.value),placeholder:"Enter coupon code",className:"uppercase flex-1 border border-foreground/50 px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm focus:outline-none focus:ring-1 focus:ring-foreground"}),e.jsx(o.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(G,{text:"Apply",onSubmitHandler:l,className:"text-xs sm:text-sm py-1 sm:py-2 px-3 sm:px-4"})})]}),p&&e.jsxs("div",{className:"mt-2 text-sm text-green-600",children:["Applied coupon: ",p," (",y,"% off)",e.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:g,className:"ml-2 text-red-500",children:"Remove"})]})]})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:a,disabled:c||i,className:`hidden lg:flex group relative h-9 sm:h-10 md:h-12 items-center justify-center overflow-hidden px-3 sm:px-4 md:px-6 font-light text-neutral-200 text-xs sm:text-sm md:text-base tracking-wide w-full mt-2 sm:mt-4 uppercase ${c?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-foreground"}`,children:i?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-t-transparent border-white"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Proceed To Checkout"}),e.jsx("div",{className:"absolute inset-0 flex h-full w-full justify-center [transform:skew(-12deg)_translateX(-100%)] group-hover:duration-1000 group-hover:[transform:skew(-12deg)_translateX(100%)]",children:e.jsx("div",{className:"relative h-full w-6 sm:w-8 bg-white/20"})})]})})]})}function oe({cartItems:s,isBuyNow:r,setLocalQty:d,setBuyNowItem:m,setStepCount:n}){console.log("is buy now from shopping Bag",r);const u=O(),l=M(),a=A(h=>h.user.user),i=s.reduce((h,b)=>h+b.finalPrice*b.quantity,0),[c,p]=f.useState(""),[g,y]=f.useState(0),[t,x]=f.useState(null),[w,T]=f.useState(!1),I=i*g/100,S=i-I,N=s.length===0,_=async()=>{var h,b;if(!c.trim()){F.error("Please enter a coupon code");return}if(c===t){F.info("Coupon already applied");return}try{const v=(await C.post("/user/coupon/apply",{couponCode:c})).data;typeof v=="number"&&v>0?(y(v),x(c),l(K({discountPercentage:v})),F.success("Coupon applied successfully!")):F.error("Invalid coupon code")}catch(j){F.error(((b=(h=j==null?void 0:j.response)==null?void 0:h.data)==null?void 0:b.message)||"Failed to  apply coupon"),console.error(j)}},D=()=>{y(0),x(null),p(""),l(X),F.success("Coupon removed")},E=()=>{if(N){F.error("Your cart is empty");return}if(!a){u("/login");return}T(!0),n(h=>h+1)},z=async(h,b,j)=>{const v=s[j];if(!v||v._id!==h)return;if(r){d(q=>Math.max(1,b>0?q+1:q-1));return}if(a)try{if(!(await C.post("/user/cart/update-quantity",{userId:a._id,productId:h,withFallPico:v.addons.withFallPico,withTassels:v.addons.withTassels,type:b===1?"increment":"decrement"})).data)return}catch(q){F.error("Something Went Wrong"),console.error(q);return}const V=Math.max(1,v.quantity+b);l(Q({id:h,quantity:V,idx:j}))},R=async(h,b)=>{if(r){m(null);return}const j=s[b];a&&await C.post("/user/cart/remove",{userId:a._id,productId:j._id,withFallPico:j.addons.withFallPico,withTassels:j.addons.withTassels}),l(Y({id:h,idx:b}))};return e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-auto w-full max-w-7xl mx-auto py-4 sm:py-6 md:py-8 px-3 sm:px-6 md:px-8",children:[e.jsx(te,{total:S,onCheckout:E,isCheckingOut:w,cartEmpty:N}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8 lg:gap-12",children:[e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"col-span-1 lg:col-span-2",children:[e.jsx(ae,{}),N?e.jsx(ne,{}):e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsx(W,{children:s.map((h,b)=>e.jsx(re,{item:h,idx:b,onIncrement:z,onDecrement:z,onRemove:R},h._id))})})]}),e.jsx(ie,{cartItems:s,subtotal:i,discount:I,total:S,coupon:c,setCoupon:p,applyCoupon:_,handleCheckout:E,isCheckingOut:w,cartEmpty:N,appliedCoupon:t,removeCoupon:D,discountPercentage:g})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 lg:hidden z-10",children:e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:E,disabled:N||w,className:`group relative flex h-12 items-center justify-center overflow-hidden font-light text-neutral-200 text-sm tracking-wide w-full uppercase ${N?"bg-gray-200 text-gray-500":"bg-foreground"}`,children:w?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-5 h-5 border-2 border-t-transparent border-white"}):e.jsxs("span",{children:["Proceed To Checkout • ₹",S.toFixed(2)]})})})]})}const H=({label:s,name:r,type:d="text",rules:m={}})=>{var x;const{register:n,formState:{errors:u},watch:l}=B(),[a,i]=$.useState(!1),[c,p]=$.useState(!1),g=l(r);f.useEffect(()=>{p(!!g)},[g]);const y=()=>i(!0),t=()=>i(!1);return e.jsxs("div",{className:"relative mb-6",children:[e.jsx("input",{id:r,name:r,type:d,className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear",placeholder:" ",...n(r,m),onFocus:y,onBlur:t,onAnimationStart:w=>{w.animationName==="onAutoFillStart"&&p(!0)}}),e.jsx("label",{htmlFor:r,className:`absolute capitalize px-2 z-10 bg-white left-3 transition-all duration-200 ${a||c?"top-0 text-xs text-foreground":"top-1/2 text-base text-foreground"} transform ${u[r],"-translate-y-1/2"}`,children:s}),u[r]&&e.jsx("p",{className:"text-red-500 text-xs mt-1 absolute",children:(x=u[r])==null?void 0:x.message})]})},le=({label:s,name:r,options:d,rules:m={}})=>{var i;const{register:n,formState:{errors:u},watch:l}=B(),a=l(r);return f.useEffect(()=>{const c=document.getElementById(r);c&&c.addEventListener("animationstart",p=>{p.animationName==="onAutoFillStart"&&c.dispatchEvent(new Event("change",{bubbles:!0}))})},[r]),e.jsxs("div",{className:"relative mb-6",children:[e.jsxs("select",{id:r,name:r,className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear bg-white",...n(r,m),children:[e.jsxs("option",{value:"",disabled:!0,children:["Select ",s]}),d.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("label",{htmlFor:r,className:`absolute capitalize px-2 z-10 bg-white left-3 transition-all duration-200 ${a?"top-0 text-xs text-foreground":"top-1/2 text-base text-foreground"} transform ${u[r],"-translate-y-1/2"}`,children:s}),u[r]&&e.jsx("p",{className:"text-red-500 text-xs mt-1 absolute",children:(i=u[r])==null?void 0:i.message})]})},de=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],ce={street:"",city:"",state:"",postalCode:"",phone:""},ue=({addresses:s,setAddresses:r})=>{const[d,m]=f.useState("new"),n=B();f.useEffect(()=>{(async()=>{try{const{data:a}=await C.get("/user/address/getAll");r((a==null?void 0:a.addresses)||[])}catch(a){console.error("Error fetching addresses:",a)}})()},[]),f.useEffect(()=>{n.setValue("addressId",d)},[d,n]);const u=f.useCallback(l=>{const a=l.target.value;if(m(a),a==="new"){n.reset(ce),n.setFocus("street");return}const i=s.find(c=>c._id===a);if(!i){console.warn("Selected address not found");return}n.setValue("street",i.street),n.setValue("city",i.city),n.setValue("state",i.state),n.setValue("postalCode",i.postalCode),n.setValue("phone",i.phone)},[s,n]);return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold uppercase text-foreground mb-4",children:"Shipping Information"}),s.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Saved Address"}),e.jsxs("select",{value:d,onChange:u,defaultValue:"new",className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear bg-white",children:[e.jsx("option",{value:"new",disabled:!0,hidden:!0,children:"Select an address or add new"}),s.map(l=>e.jsx("option",{value:l._id,children:`${l.street}, ${l.city}, ${l.state}`},l._id)),e.jsx("option",{value:"new",children:"Add New Address"})]})]}),e.jsx("input",{type:"hidden",...n.register("addressId")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(H,{label:"Street Address",name:"street",rules:{required:"Street address is required",minLength:{value:5,message:"Minimum 5 characters"}}}),e.jsx(H,{label:"City",name:"city",rules:{required:"City is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Letters & spaces only"}}}),e.jsx(le,{label:"State",name:"state",options:de,rules:{required:"State is required"}}),e.jsx(H,{label:"Postal Code",name:"postalCode",rules:{required:"Postal code is required",pattern:{value:/^\d{6}$/,message:"6 digits required"}}}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(H,{label:"Phone",name:"phone",type:"tel",rules:{required:"Phone number is required",pattern:{value:/^\d{10}$/,message:"10 digits required"}}})})]})]})},L=$.memo(function({cartItems:r,subtotal:d,gst:m,total:n}){const u=A(a=>{var i;return(i=a==null?void 0:a.cart)==null?void 0:i.discountPercentage}),l=d*u/100;return console.log("Discount ->",l),e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},className:"col-span-1 p-3 sm:p-4 md:p-6 border shadow-sm",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium uppercase text-foreground mb-3 sm:mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 text-xs sm:text-sm md:text-base",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Your Cart"}),r.map((a,i)=>{const c=a.finalPrice-(a.addons.withFallPico?P:0)-(a.addons.withTassels?k:0),p=a.finalPrice*a.quantity;return e.jsxs("div",{className:"mb-3 border-b pb-2",children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsxs("p",{children:["Base Price: ₹",c.toFixed(2)," ×"," ",a.quantity," = ₹",(c*a.quantity).toFixed(2)]}),a.addons.withFallPico&&e.jsxs("p",{children:["With Fall Pico: +₹",P," ×"," ",a.quantity," = ₹",(P*a.quantity).toFixed(2)]}),a.addons.withTassels&&e.jsxs("p",{children:["With Tassels: +₹",k," ×"," ",a.quantity," = ₹",(k*a.quantity).toFixed(2)]}),e.jsxs("p",{className:"font-medium",children:["Item Total: ₹",p.toFixed(2)]})]},i)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",d.toFixed(2)]})]}),l&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-₹",l.toFixed(2)]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-sm",children:["Including ₹",m," in taxes (5% GST)"]})}),e.jsx("div",{className:"border-t border-foreground/50 pt-2 sm:pt-3 mt-2 sm:mt-3",children:e.jsxs("div",{className:"flex justify-between text-sm sm:text-base md:text-lg font-semibold text-foreground",children:[e.jsx("span",{children:"Total"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},children:["₹",n.toFixed(2)]},n)]})})]})]})]})});function xe({cartItems:s,setStepCount:r}){const[d,m]=f.useState([]),n=A(t=>{var x;return(x=t==null?void 0:t.user)==null?void 0:x.user}),u=A(t=>{var x;return(x=t==null?void 0:t.cart)==null?void 0:x.discountPercentage}),l=se(),a=U(),i=s.reduce((t,x)=>t+x.finalPrice*x.quantity,0),c=+(i*.05).toFixed(2),p=i*u/100,g=p?i-p:i,y=async t=>{let x=!1;if(t.addressId==="new"){const{data:{address:S}}=await C.post("/user/address/add",t);m(N=>[...N,S]),x=S._id}const{data:{key:w}}=await C.get("/payment/get-razorpay-key"),{data:T}=await C.post("/payment/checkout",{amount:g,userId:n==null?void 0:n._id,items:s,discount:p,offer:l||0,addressId:x||t.addressId}),I=new window.Razorpay({key:w,amount:T.amount,currency:"INR",name:"Srijan Fabs",description:"",image:"LOGO.avif",order_id:T.id,callback_url:"https://srijanfabs.co.in/api/v1/payment/verify-payment",prefill:{name:(n==null?void 0:n.name)||"",email:(n==null?void 0:n.email)||"",contact:(n==null?void 0:n.phone)||""},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}});I.on("payment.failed",S=>{var _;const N=slugify(((_=S.error)==null?void 0:_.reason)||"payment_failed",{lower:!0,strict:!0});window.location.href=`paymentFailed?reason=${N}`}),I.open()};return e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-auto w-full py-8 bg-white px-4 md:px-8",children:e.jsx(J,{...a,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-8",children:[e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsxs("form",{onSubmit:a.handleSubmit(y),children:[e.jsx(ue,{addresses:d,setAddresses:m}),e.jsx("div",{className:"block md:hidden",children:e.jsx(L,{cartItems:s,subtotal:i,gst:c,total:g})}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},className:"flex flex-col md:flex-row justify-between mt-8 gap-4",children:[e.jsxs(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",onClick:()=>r(1),className:"flex items-center justify-center gap-2 border-[2px] border-foreground/50 text-foreground h-12 px-4 md:px-6 w-full uppercase hover:border-foreground hover:bg-foreground/5 transition-all duration-200",children:[e.jsx(Z,{className:"text-foreground"}),e.jsx("span",{children:"Back to Shopping Bag"})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:a.formState.isSubmitting,className:"group relative inline-flex h-12 items-center justify-center overflow-hidden bg-foreground px-4 md:px-6 font-light text-neutral-200 text-md tracking-wide w-full uppercase disabled:opacity-50",children:a.formState.isSubmitting?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1},className:"w-5 h-5 border-2 border-t-transparent border-white rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Proceed To Confirmation"}),e.jsx("div",{className:"absolute inset-0 flex h-full w-full justify-center [transform:skew(-12deg)_translateX(-100%)] group-hover:duration-1000 group-hover:[transform:skew(-12deg)_translateX(100%)]",children:e.jsx("div",{className:"relative h-full w-8 bg-white/20"})})]})})]})]})}),e.jsx("div",{className:"hidden md:block ",children:e.jsx(L,{cartItems:s,subtotal:i,gst:c,total:g})})]})})})}function fe(){var y;const r=((y=ee().state)==null?void 0:y.buyNowItem)||null,[d,m]=f.useState(r),n=!!d,[u,l]=f.useState(()=>d&&d.quantity||1),a=A(t=>t.cart.cartItems),i=n?[{...d,quantity:u}]:a;f.useEffect(()=>{n&&l(d.quantity||1)},[d,n]),i.reduce((t,x)=>t+x.finalPrice*x.quantity,0);const c=[{id:1,heading:"Shopping Bag",subHeading:"Manage Your Items list"},{id:2,heading:"Shipping And Checkout",subHeading:"Checkout your item list"},{id:3,heading:"Confirmation",subHeading:"Review and submit your order"}],[p,g]=f.useState(1);return e.jsxs("div",{className:"boxedContainer h-auto w-full py-4 sm:py-6 md:py-8 px-3 sm:px-6 md:px-8 max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-[35px] font-bold uppercase mb-4 sm:mb-6",children:"Cart"}),e.jsxs("div",{className:"w-full mb-6 sm:mb-8",children:[e.jsxs("div",{className:"relative flex justify-between items-center md:hidden mb-6",children:[e.jsx("div",{className:"absolute top-3 left-0 right-0 h-0.5 bg-foreground"}),c.map(t=>e.jsxs("div",{className:"relative z-10 flex flex-col items-center w-1/3",children:[e.jsx("div",{className:`w-6 h-6 flex items-center justify-center text-xs font-medium
                                    ${p>=t.id?"bg-foreground text-white":"bg-white  border border-foreground text-foreground"}`,children:t.id}),e.jsx("span",{className:"text-[10px] sm:text-xs mt-2 text-center font-medium leading-tight",children:t.heading.split(" ")[0]})]},t.id))]}),e.jsx("div",{className:"hidden md:grid w-full grid-cols-3 gap-4",children:c.map(t=>e.jsxs("div",{className:`flex gap-4 py-2 ${p>=t.id?"border-b-2 border-foreground":"border-b border-foreground/50"}`,children:[e.jsxs("h1",{className:"text-sm md:text-base lg:text-[18px] uppercase font-medium",children:["0",t.id]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm md:text-base lg:text-[18px] uppercase font-medium text-foreground",children:t.heading}),e.jsx("h2",{className:"text-foreground text-xs md:text-sm",children:t.subHeading})]})]},t.id))})]}),e.jsxs("div",{className:"w-full",children:[p===1&&e.jsx(oe,{cartItems:i,isBuyNow:n,setLocalQty:l,setBuyNowItem:m,setStepCount:g}),p===2&&e.jsx(xe,{cartItems:i,setStepCount:g})]})]})}export{fe as default};
