import{a as P,u as F,d as x,r as b,e as I,j as e,m as k,I as t,aB as A,W as R,at as d,aC as U,h as D}from"./index-BJZVsLRM.js";import{S as h}from"./SelectField-D2mdJDlv.js";import{u as E}from"./uploadMedia-BSrAngoH.js";import{p as H}from"./product.api-BG8uAXJK.js";const T=()=>{const{register:r,handleSubmit:j,formState:{errors:a},reset:g}=P(),f=F(),v=x(s=>s.category.categories||[]),u=x(s=>s.fabrics),[m,o]=b.useState([]),[p,n]=b.useState([]),y=I(),q=s=>{const i=Array.from(s.target.files);o(i);const l=i.map(c=>URL.createObjectURL(c));n(l)},w=s=>{const i=[...m],l=[...p];i.splice(s,1),l.splice(s,1),o(i),n(l)},N=async s=>{if(m.length===0){d.error("Please upload at least one image.");return}const i=d.loading("Please wait...");try{const l={type:"products",identifier:s.productId||s.name},c=await E(m,l);if(!c)return;s.images=c;const C=await H.createProduct(s);y(U(C)),g(),o([]),n([]),d.success("Product created successfully")}catch(l){D(l)}finally{d.dismiss(i)}},S=()=>{g(),o([]),n([]),f(-1)};return e.jsxs(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},className:"space-y-6 p-4 sm:p-6 max-w-2xl mx-auto",children:[e.jsx("h3",{className:"text-lg font-semibold uppercase text-gray-800 mb-4 tracking-wide",children:"Add Product"}),e.jsxs("form",{onSubmit:j(N),className:"space-y-4",children:[e.jsx(t,{label:"Name",name:"name",register:r,errors:a,rules:{required:"Product name is required"}}),e.jsx(t,{label:"Description",name:"description",register:r,errors:a,rules:{required:"Description is required"}}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Price",name:"price",type:"number",register:r,errors:a,rules:{required:"Price is required",min:{value:0,message:"Must be positive"}}}),e.jsx(t,{label:"Stock",name:"stock",type:"number",register:r,errors:a,rules:{required:"Stock is required",min:{value:0,message:"Must be positive"}}})]}),e.jsx(h,{label:"Category",name:"category",register:r,errors:a,rules:{required:"Category is required"},options:v.map(s=>({value:s._id||s.value,label:s.name||s.label,disabled:s.name=="all"}))}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1 flex items-center gap-2",children:[e.jsx(A,{size:16})," Images"]}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md text-sm text-gray-800"}),p.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:p.map((s,i)=>e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("img",{src:s,alt:`Preview ${i}`,className:"w-full h-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>w(i),className:"absolute top-0 right-0 bg-white rounded-full p-0.5 shadow-md",children:e.jsx(R,{size:12})})]},i))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(h,{label:"Fabric",name:"fabric",register:r,errors:a,rules:{required:"Fabric is required"},options:u==null?void 0:u.map(s=>({value:s._id||s.value,label:s.title||s.label}))}),e.jsx(t,{label:"Technique",name:"technique",register:r,errors:a,rules:{required:"Technique is required"}})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Color",name:"color",register:r,errors:a,rules:{required:"Color is required"}}),e.jsx(t,{label:"Weight (KG)",name:"weight",register:r,errors:a,rules:{required:"Weight is required"}})]}),e.jsx(t,{label:"Assurance",name:"assurance",register:r,errors:a,rules:{required:"Assurance is required"}}),e.jsx(t,{label:"HSN Code",name:"hsnCode",register:r,value:"5507",errors:a,rules:{required:"HSN Code is required",pattern:{value:/^[0-9]+$/,message:"HSN Code must contain only numbers"}}}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{type:"submit",className:"bg-neutral-950 h-12 text-white px-4 py-2 text-sm uppercase hover:bg-gray-700 transition-colors duration-200 shadow-md w-full",children:"Save"}),e.jsx("button",{type:"button",onClick:S,className:"bg-gray-200 text-gray-800 px-4 py-2 text-sm uppercase hover:bg-gray-300 transition-colors duration-200 shadow-md w-full",children:"Cancel"})]})]})]})};export{T as default};
